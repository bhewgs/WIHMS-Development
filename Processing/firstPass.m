function y = firstPass(x, Fs)
persistent Hd;
if isempty(Hd)   
    % The following code was used to design the filter coefficients:
    %
    Fstop1 = 0.25;      % First Stopband Frequency
    Fpass1 = 0.35;       % First Passband Frequency
    
    Fstop1 = 0.4;      % First Stopband Frequency
    Fpass1 = 0.5;       % First Passband Frequency
    
    if ((Fs/2)<100)
        Fpass2 = (Fs/2)-.05;   % Second Passband Frequency
        Fstop2 = (Fs/2);   % Second Stopband Frequency
    else
        Fpass2 = 99.5;   % Second Passband Frequency
        Fstop2 = 100;   % Second Stopband Frequency
    end
    Astop1 = 80;        % First Stopband Attenuation (dB)
    Apass  = 1;         % Passband Ripple (dB)
    Astop2 = 80;        % Second Stopband Attenuation (dB)
    Fs     = Fs;  % Sampling Frequency    
    h = fdesign.bandpass('fst1,fp1,fp2,fst2,ast1,ap,ast2', Fstop1, Fpass1, ...
                         Fpass2, Fstop2, Astop1, Apass, Astop2, Fs);    
    Hd = design(h, 'butter', ...
        'MatchExactly', 'passband', ...
        'SystemObject', true);    
%     Hd = dsp.BiquadFilter( ...
%         'Structure', 'Direct form II', ...
%         'SOSMatrix', [1 0 -1 1 1.99993377196852 0.999937292911176; 1 0 -1 1 ...
%         -1.99902115713841 0.999373142155225; 1 0 -1 1 1.99980843981711 ...
%         0.999811960539394; 1 0 -1 1 -1.99776953879527 0.99812130345642; 1 0 -1 1 ...
%         1.99968333329864 0.999686853801221; 1 0 -1 1 -1.99652157962371 ...
%         0.996873124600962; 1 0 -1 1 1.99955859200427 0.999562112288062; 1 0 -1 1 ...
%         -1.99527865976629 0.995629985974138; 1 0 -1 1 1.99943435506612 ...
%         0.999437875132292; 1 0 -1 1 -1.99404214863431 0.994393257227947; 1 0 -1 ...
%         1 1.99931076100296 0.999314280852893; 1 0 -1 1 -1.992813403479 ...
%         0.993164295852079; 1 0 -1 1 1.99918794756662 0.999191467201955; 1 0 -1 1 ...
%         -1.991593767998 0.991944445780095; 1 0 -1 1 1.99906605158968 ...
%         0.999069571012279; 1 0 -1 1 -1.99038457097769 0.990735036031613; 1 0 -1 ...
%         1 1.99894520883422 0.998948728046181; 1 0 -1 1 -1.98918712497248 ...
%         0.989537379391251; 1 0 -1 1 1.99882555384206 0.998829072845711; 1 0 -1 1 ...
%         -1.98800272502124 0.988352771124962; 1 0 -1 1 1.9987072197865 ...
%         0.998710738584389; 1 0 -1 1 -1.98683264740181 0.987182487734216; 1 0 -1 ...
%         1 1.99859033832579 0.998593856920681; 1 0 -1 1 -1.98567814842358 ...
%         0.986027785748444; 1 0 -1 1 1.99847503945841 0.998478557853288; 1 0 -1 1 ...
%         -1.98454046325867 0.984889900556005; 1 0 -1 1 1.99836145138041 ...
%         0.998364969578472; 1 0 -1 1 -1.98342080481186 0.983770045273879; 1 0 -1 ...
%         1 1.99824970034487 0.998253218349515; 1 0 -1 1 -1.98232036262916 ...
%         0.98266940965613; 1 0 -1 1 1.99813991052364 0.998143428338488; 1 0 -1 1 ...
%         -1.98124030184536 0.981589159041203; 1 0 -1 1 1.99803220387159 ...
%         0.99803572150045; 1 0 -1 1 -1.98018176217013 0.980530433337881; 1 0 -1 1 ...
%         1.99792669999336 0.997930217440223; 1 0 -1 1 -1.97914585691272 ...
%         0.979494346049833; 1 0 -1 1 1.99782351601283 0.997827033281894; 1 0 -1 1 ...
%         -1.97813367204493 0.97848198333843; 1 0 -1 1 1.99772276644549 ...
%         0.997726283541136; 1 0 -1 1 -1.97714626530217 0.977494403123592; 1 0 -1 ...
%         1 1.99762456307374 0.997628080000521; 1 0 -1 1 -1.97618466532201 ...
%         0.976532634222283; 1 0 -1 1 1.9975290148253 0.997532531587936; 1 0 -1 1 ...
%         -1.9752498708201 0.975597675524232; 1 0 -1 1 1.99743622765479 ...
%         0.997439744258194; 1 0 -1 1 -1.97434284980279 0.974690495204441; 1 0 -1 ...
%         1 1.99734630442879 0.997349820878011; 1 0 -1 1 -1.97346453881602 ...
%         0.973812029971952; 1 0 -1 1 1.99725934481417 0.997262861114422; 1 0 -1 1 ...
%         -1.97261584222995 0.972963184354369; 1 0 -1 1 1.99717544517011 ...
%         0.997178961326773; 1 0 -1 1 -1.97179763155878 0.972144830017546; 1 0 -1 ...
%         1 1.99709469844377 0.997098214462356; 1 0 -1 1 -1.97101074481511 ...
%         0.971357805119837; 1 0 -1 1 1.9970171940697 0.997020709955859; 1 0 -1 1 ...
%         -1.97025598589827 0.970602913700355; 1 0 -1 1 1.99694301787315 ...
%         0.996946533632659; 1 0 -1 1 -1.969534124016 0.969880925100535; 1 0 -1 1 ...
%         1.99687225197731 0.996875767616097; 1 0 -1 1 -1.96884589313883 ...
%         0.969192573418438; 1 0 -1 1 1.99680497471473 0.99680849023882; 1 0 -1 1 ...
%         -1.96819199148655 0.968538556995128; 1 0 -1 1 1.9967412605427 ...
%         0.996744775958246; 1 0 -1 1 -1.96757308104613 0.967919537932512; 1 0 -1 ...
%         1 1.99668117996304 0.996684695276294; 1 0 -1 1 -1.96698978712039 ...
%         0.96733614164196; 1 0 -1 1 1.99662479944607 0.996628314663391; 1 0 -1 1 ...
%         -1.96644269790697 0.966788956423172; 1 0 -1 1 1.99657218135904 ...
%         0.996575696486882; 1 0 -1 1 -1.96593236410682 0.966278533072634; 1 0 -1 ...
%         1 1.99652338389899 0.996526898943894; 1 0 -1 1 -1.96545929856172 ...
%         0.965805384521069; 1 0 -1 1 1.99647846103011 0.996481975998701; 1 0 -1 1 ...
%         -1.96502397592024 0.965369985499362; 1 0 -1 1 1.99643746242572 ...
%         0.996440977324687; 1 0 -1 1 -1.9646268323317 0.964972772232416; 1 0 -1 1 ...
%         1.99640043341483 0.996403948250945; 1 0 -1 1 -1.96426826516735 ...
%         0.96461414216038; 1 0 -1 1 1.99636741493345 0.996370929713548; 1 0 -1 1 ...
%         -1.96394863276871 0.96429445368685; 1 0 -1 1 1.99633844348062 ...
%         0.996341958211574; 1 0 -1 1 -1.9636682542222 0.964014025953541; 1 0 -1 1 ...
%         1.99631355107916 0.996317065767902; 1 0 -1 1 -1.96342740916 ...
%         0.963773138641066; 1 0 -1 1 1.99629276524132 0.996296279894823; 1 0 -1 1 ...
%         -1.96322633758653 0.963572031795414; 1 0 -1 1 1.99627610893923 ...
%         0.996279623564505; 1 0 -1 1 -1.96306523973039 0.963410905679864; 1 0 -1 ...
%         1 1.99626360058026 0.996267115184329; 1 0 -1 1 -1.96294427592138 ...
%         0.963289920651984; 1 0 -1 1 1.99625525398723 0.996258768577154; 1 0 -1 1 ...
%         -1.96286356649243 0.963209197065537; 1 0 -1 1 1.9962510783836 ...
%         0.996254592966456; 1 0 -1 1 -1.96282319170619 0.963168815197075], ...
%         'ScaleValues', [0.99977435740392; 0.99977435740392; ...
%         0.999430042819772; 0.999430042819772; 0.999086659776665; ...
%         0.999086659776665; 0.998744588807521; 0.998744588807521; ...
%         0.998404207818377; 0.998404207818377; 0.998065891688014; ...
%         0.998065891688014; 0.997730011875921; 0.997730011875921; ...
%         0.997396936038879; 0.997396936038879; 0.997067027656426; ...
%         0.997067027656426; 0.996740645665434; 0.996740645665434; ...
%         0.996418144103996; 0.996418144103996; 0.996099871764814; ...
%         0.996099871764814; 0.99578617185822; 0.99578617185822; ...
%         0.995477381684976; 0.995477381684976; 0.995173832318935; ...
%         0.995173832318935; 0.994875848299661; 0.994875848299661; ...
%         0.994583747335059; 0.994583747335059; 0.994297840014046; ...
%         0.994297840014046; 0.994018429529302; 0.994018429529302; ...
%         0.993745811410085; 0.993745811410085; 0.993480273265105; ...
%         0.993480273265105; 0.993222094535429; 0.993222094535429; ...
%         0.992971546257371; 0.992971546257371; 0.992728890835314; ...
%         0.992728890835314; 0.992494381824403; 0.992494381824403; ...
%         0.992268263723026; 0.992268263723026; 0.99205077177501; ...
%         0.99205077177501; 0.991842131781434; 0.991842131781434; ...
%         0.991642559921963; 0.991642559921963; 0.991452262585613; ...
%         0.991452262585613; 0.99127143621083; 0.99127143621083; ...
%         0.991100267134785; 0.991100267134785; 0.990938931451775; ...
%         0.990938931451775; 0.990787594880625; 0.990787594880625; ...
%         0.990646412640982; 0.990646412640982; 0.990515529338397; ...
%         0.990515529338397; 0.990395078858096; 0.990395078858096; ...
%         0.990285184267334; 0.990285184267334; 0.990185957726258; ...
%         0.990185957726258; 0.990097500407154; 0.990097500407154; ...
%         0.990019902422041; 0.990019902422041; 0.989953242758497; ...
%         0.989953242758497; 0.989897589223669; 0.989897589223669; ...
%         0.989852998396399; 0.989852998396399; 0.989819515587412; ...
%         0.989819515587412; 0.989797174807523; 0.989797174807523; ...
%         0.989785998743825; 0.989785998743825; 1]);
end

s = double(x);
y = step(Hd,s);

