function y = remove60hz(x,Fs)
%DOFILTER Filters input x and returns output y.

% MATLAB Code
% Generated by MATLAB(R) 9.7 and DSP System Toolbox 9.9.
% Generated on: 13-Jan-2020 17:15:56

%#codegen

% To generate C/C++ code from this function use the codegen command.
% Type 'help codegen' for more information.

persistent Hd;

if isempty(Hd)
    
    % The following code was used to design the filter coefficients:
    %
    Fpass1 = 59;      % First Passband Frequency
    Fstop1 = 59.25;     % First Stopband Frequency
    Fstop2 = 60.75;     % Second Stopband Frequency
    Fpass2 = 61;      % Second Passband Frequency
    Apass1 = 1;         % First Passband Ripple (dB)
    Astop  = 60;        % Stopband Attenuation (dB)
    Apass2 = 1;         % Second Passband Ripple (dB)
    Fs     = Fs;  % Sampling Frequency
    
    h = fdesign.bandstop('fp1,fst1,fst2,fp2,ap1,ast,ap2', Fpass1, Fstop1, ...
                         Fstop2, Fpass2, Apass1, Astop, Apass2, Fs);
    
    Hd = design(h, 'butter', ...
        'MatchExactly', 'passband', ...
        'SystemObject', true);
    
%     Hd = dsp.BiquadFilter( ...
%         'Structure', 'Direct form II', ...
%         'SOSMatrix', [1 1.28434936443608 1 1 1.25484013196331 ...
%         0.999228003173635; 1 1.28434936443608 1 1 1.31199064628499 ...
%         0.999251729004628; 1 1.28434936443608 1 1 1.25392194602416 ...
%         0.997687134887432; 1 1.28434936443608 1 1 1.31096443220487 ...
%         0.997758046953525; 1 1.28434936443608 1 1 1.25305652317072 ...
%         0.996152647640439; 1 1.28434936443608 1 1 1.3098961757431 ...
%         0.996270132742324; 1 1.28434936443608 1 1 1.25224522987544 ...
%         0.994627176644478; 1 1.28434936443608 1 1 1.30878764394327 ...
%         0.994790315375059; 1 1.28434936443608 1 1 1.25148932941383 ...
%         0.993113328274409; 1 1.28434936443608 1 1 1.30764065612568 ...
%         0.99332090244837; 1 1.28434936443608 1 1 1.25078998043544 ...
%         0.991613675396991; 1 1.28434936443608 1 1 1.30645708113303 ...
%         0.991864177387274; 1 1.28434936443608 1 1 1.2501482357811 ...
%         0.990130752851204; 1 1.28434936443608 1 1 1.30523883458608 ...
%         0.990422396755211; 1 1.28434936443608 1 1 1.24956504154376 ...
%         0.9886670530882; 1 1.28434936443608 1 1 1.30398787614841 ...
%         0.988997787633836; 1 1.28434936443608 1 1 1.24904123636651 ...
%         0.987225021976133; 1 1.28434936443608 1 1 1.3027062068024 ...
%         0.98759254507083; 1 1.28434936443608 1 1 1.24857755097393 ...
%         0.985807054777215; 1 1.28434936443608 1 1 1.30139586613425 ...
%         0.986208829590191; 1 1.28434936443608 1 1 1.24817460792917 ...
%         0.984415492299522; 1 1.28434936443608 1 1 1.30005892962958 ...
%         0.984848764764017; 1 1.28434936443608 1 1 1.24783292161191 ...
%         0.983052617229665; 1 1.28434936443608 1 1 1.29869750597663 ...
%         0.983514434840209; 1 1.28434936443608 1 1 1.24755289840887 ...
%         0.981720650647829; 1 1.28434936443608 1 1 1.29731373437756 ...
%         0.982207882424445; 1 1.28434936443608 1 1 1.24733483711077 ...
%         0.980421748728346; 1 1.28434936443608 1 1 1.2959097818649 ...
%         0.980931106212595; 1 1.28434936443608 1 1 1.24717892950728 ...
%         0.979157999627587; 1 1.28434936443608 1 1 1.29448784062254 ...
%         0.979686058770554; 1 1.28434936443608 1 1 1.24708526117292 ...
%         0.977931420559816; 1 1.28434936443608 1 1 1.29305012530831 ...
%         0.978474644359189; 1 1.28434936443608 1 1 1.24705381243524 ...
%         0.97674395506173; 1 1.28434936443608 1 1 1.29159887037697 ...
%         0.977298716801576; 1 1.28434936443608 1 1 1.24708445951747 ...
%         0.975597470445207; 1 1.28434936443608 1 1 1.29013632740083 ...
%         0.976160077390748; 1 1.28434936443608 1 1 1.24717697584728 ...
%         0.97449375543804; 1 1.28434936443608 1 1 1.28866476238617 ...
%         0.975060472835453; 1 1.28434936443608 1 1 1.24733103352324 ...
%         0.973434518010962; 1 1.28434936443608 1 1 1.28718645308281 ...
%         0.974001593242776; 1 1.28434936443608 1 1 1.24754620493028 ...
%         0.972421383388993; 1 1.28434936443608 1 1 1.28570368628558 ...
%         0.972985070136877; 1 1.28434936443608 1 1 1.24782196449589 ...
%         0.971455892245826; 1 1.28434936443608 1 1 1.2842187551248 ...
%         0.972012474511839; 1 1.28434936443608 1 1 1.24815769057938 ...
%         0.970539499077963; 1 1.28434936443608 1 1 1.2827339563435 ...
%         0.971085314918954; 1 1.28434936443608 1 1 1.2485526674839 ...
%         0.969673570755288; 1 1.28434936443608 1 1 1.28125158756146 ...
%         0.970205035588803; 1 1.28434936443608 1 1 1.24900608758503 ...
%         0.968859385246018; 1 1.28434936443608 1 1 1.27977394452201 ...
%         0.969373014586988; 1 1.28434936443608 1 1 1.24951705356676 ...
%         0.968098130511133; 1 1.28434936443608 1 1 1.27830331832172 ...
%         0.968590562005491; 1 1.28434936443608 1 1 1.25008458075576 ...
%         0.967390903564647; 1 1.28434936443608 1 1 1.27684199262235 ...
%         0.967858918190571; 1 1.28434936443608 1 1 1.25070759954871 ...
%         0.966738709696383; 1 1.28434936443608 1 1 1.27539224084183 ...
%         0.967179252007647; 1 1.28434936443608 1 1 1.25138495792155 ...
%         0.966142461851494; 1 1.28434936443608 1 1 1.27395632332676 ...
%         0.966552659146323; 1 1.28434936443608 1 1 1.25211542401621 ...
%         0.965602980163179; 1 1.28434936443608 1 1 1.27253648450324 ...
%         0.965980160466776; 1 1.28434936443608 1 1 1.25289768879415 ...
%         0.965120991632804; 1 1.28434936443608 1 1 1.27113495000918 ...
%         0.965462700390894; 1 1.28434936443608 1 1 1.25373036875377 ...
%         0.96469712995443; 1 1.28434936443608 1 1 1.26975392380422 ...
%         0.965001145339123; 1 1.28434936443608 1 1 1.25461200869917 ...
%         0.964331935475314; 1 1.28434936443608 1 1 1.26839558526372 ...
%         0.96459628221953; 1 1.28434936443608 1 1 1.25554108455906 ...
%         0.964025855290455; 1 1.28434936443608 1 1 1.26706208625209 ...
%         0.964248816969327; 1 1.28434936443608 1 1 1.25651600624587 ...
%         0.963779243464818; 1 1.28434936443608 1 1 1.26575554818074 ...
%         0.963959373153584; 1 1.28434936443608 1 1 1.25753512054937 ...
%         0.963592361375476; 1 1.28434936443608 1 1 1.26447805905158 ...
%         0.963728490627711; 1 1.28434936443608 1 1 1.25859671405997 ...
%         0.963465378173332; 1 1.28434936443608 1 1 1.26323167048767 ...
%         0.963556624262904; 1 1.28434936443608 1 1 1.25969901611591 ...
%         0.963398371354755; 1 1.28434936443608 1 1 1.26201839475306 ...
%         0.963444142743148; 1 1.28434936443608 1 1 1.26084020176729 ...
%         0.963391327438216], ...
%         'ScaleValues', [0.999446286811413; 0.999446286811413; ...
%         0.998688357496885; 0.998688357496885; 0.997934036231015; ...
%         0.997934036231015; 0.99718455495677; 0.99718455495677; 0.99644112936242; ...
%         0.99644112936242; 0.995704957117785; 0.995704957117785; ...
%         0.994977216189828; 0.994977216189828; 0.994259063237732; ...
%         0.994259063237732; 0.993551632087178; 0.993551632087178; ...
%         0.99285603228324; 0.99285603228324; 0.992173347720964; ...
%         0.992173347720964; 0.991504635352403; 0.991504635352403; ...
%         0.99085092396864; 0.99085092396864; 0.990213213055081; ...
%         0.990213213055081; 0.989592471718072; 0.989592471718072; ...
%         0.988989637680771; 0.988989637680771; 0.988405616345992; ...
%         0.988405616345992; 0.987841279923658; 0.987841279923658; ...
%         0.987297466620381; 0.987297466620381; 0.986774979888624; ...
%         0.986774979888624; 0.986274587732839; 0.986274587732839; ...
%         0.985797022069965; 0.985797022069965; 0.985342978141652; ...
%         0.985342978141652; 0.984913113975606; 0.984913113975606; ...
%         0.984508049893471; 0.984508049893471; 0.984128368062736; ...
%         0.984128368062736; 0.983774612090218; 0.983774612090218; ...
%         0.983447286654753; 0.983447286654753; 0.983146857176845; ...
%         0.983146857176845; 0.98287374952313; 0.98287374952313; ...
%         0.982628349743628; 0.982628349743628; 0.982411003839929; ...
%         0.982411003839929; 0.98222201756257; 0.98222201756257; 0.98206165623604; ...
%         0.98206165623604; 0.981930144610015; 0.981930144610015; ...
%         0.981827666735597; 0.981827666735597; 0.98175436586549; ...
%         0.98175436586549; 0.981710344377279; 0.981710344377279; ...
%         0.981695663719108; 1]);
end

s = double(x);
y = step(Hd,s);

